# Wells

# Описание проекта
Допустим, вы работаете в добывающей компании «ГлавРосГосНефть». Нужно решить, где бурить новую скважину. 

Шаги для выбора локации обычно такие:

- В избранном регионе собирают характеристики для скважин: качество нефти и объём её запасов;
- Строят модель для предсказания объёма запасов в новых скважинах;
- Выбирают скважины с самыми высокими оценками значений;
- Определяют регион с максимальной суммарной прибылью отобранных скважин.
  
Вам предоставлены пробы нефти в трёх регионах. Характеристики для каждой скважины в регионе уже известны. Постройте модель для определения региона, где добыча принесёт наибольшую прибыль. Проанализируйте возможную прибыль и риски техникой *Bootstrap*.

## Описание данных
Данные геологоразведки трёх регионов находятся в файлах: 
- `/datasets/geo_data_0.csv`.
- `/datasets/geo_data_1.csv`.
- `/datasets/geo_data_2.csv`. 
- *id* — уникальный идентификатор скважины;
- *f0*, *f1*, *f2* — три признака точек (неважно, что они означают, но сами признаки значимы);
- *product* — объём запасов в скважине (тыс. баррелей).
### Условия задачи:

- Для обучения модели подходит только линейная регрессия (остальные — недостаточно предсказуемые).
- При разведке региона исследуют 500 точек, из которых с помощью машинного обучения выбирают 200 лучших для разработки.
- Бюджет на разработку скважин в регионе — 10 млрд рублей.
- При нынешних ценах один баррель сырья приносит 450 рублей дохода. Доход с каждой единицы продукта составляет 450 тыс. рублей, поскольку объём указан в тысячах баррелей.
- После оценки рисков нужно оставить лишь те регионы, в которых вероятность убытков меньше 2.5%. Среди них выбирают регион с наибольшей средней прибылью.
Данные синтетические: детали контрактов и характеристики месторождений не разглашаются.

## План проекта
1. Загрузить и подготовить данные.
2. Обучить и проверить модель для каждого региона:
- 2.1. Разбить данные на обучающую и валидационную выборки в соотношении 75:25.
- 2.2. Обучить модель и сделать предсказания на валидационной выборке.
- 2.3. Сохранить предсказания и правильные ответы на валидационной выборке.
- 2.4. Напечатать на экране средний запас предсказанного сырья и RMSE модели.
- 2.5. Проанализировать результаты.
3. Подготовиться к расчёту прибыли:
- 3.1. Все ключевые значения для расчётов сохранить в отдельных переменных.
- 3.2. Рассчитать достаточный объём сырья для безубыточной разработки новой скважины. Сравнить полученный объём сырья со средним запасом в каждом регионе. 
- 3.3. Написать выводы по этапу подготовки расчёта прибыли.
4. Написать функцию для расчёта прибыли по выбранным скважинам и предсказаниям модели:
- 4.1. Выберать скважины с максимальными значениями предсказаний. 
- 4.2. Просуммировать целевое значение объёма сырья, соответствующее этим предсказаниям.
- 4.3. Рассчитать прибыль для полученного объёма сырья.
5. Посчитать риски и прибыль для каждого региона:
- 5.1. Применить технику Bootstrap с 1000 выборок, чтобы найти распределение прибыли.
- 5.2. Найти среднюю прибыль, 95%-й доверительный интервал и риск убытков. Убыток — это отрицательная прибыль.
- 5.3. Написать выводы: предложить регион для разработки скважин и обосновать выбор.
